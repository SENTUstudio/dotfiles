---
- name: Instalar lazygit (git clone y go install)
  become: false # No necesitas sudo, instalamos en el directorio del usuario
  block:
    - name: Clonar el repositorio de lazygit
      ansible.builtin.git:
        repo: "https://github.com/jesseduffield/lazygit.git"
        dest: "{{ ansible_env.HOME }}/.lazygit-src" # Ruta donde quieres clonar
        version: master # O la rama que prefieras
        # update: yes # Comentada para no actualizar siempre, solo la primera vez
      register: git_result

    - name: Instalar lazygit con go install
      when: git_result.changed
      shell: "go install"
      args:
        chdir: "{{ ansible_env.HOME }}/.lazygit-src" # Navega al directorio clonado
        creates: "{{ ansible_env.HOME }}/go/bin/lazygit" # Comprueba si ya existe

